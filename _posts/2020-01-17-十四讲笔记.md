---
layout: post
title: 十四讲笔记
---

<!-- TOC -->

- [第二讲](#第二讲)
    - [2.2 经典视觉 SLAM 框架](#22-经典视觉-slam-框架)
    - [2.4 编程基础](#24-编程基础)
        - [2.4.1 使用库](#241-使用库)
- [第三讲 三维空间刚体运动](#第三讲-三维空间刚体运动)
    - [3.1 旋转矩阵](#31-旋转矩阵)
        - [3.1.1 点和向量, 坐标系](#311-点和向量-坐标系)
        - [3.1.2 坐标系之间的欧式变换](#312-坐标系之间的欧式变换)
        - [3.1.3 变换矩阵与齐次坐标](#313-变换矩阵与齐次坐标)
    - [3.2 实践: Eigen 的使用](#32-实践-eigen-的使用)
    - [3.3 旋转向量和欧拉角](#33-旋转向量和欧拉角)
        - [3.3.1 旋转向量](#331-旋转向量)
        - [3.3.2 欧拉角](#332-欧拉角)

<!-- /TOC -->

> 很惭愧, 终于开始看十四讲了.

# 第二讲

## 2.2 经典视觉 SLAM 框架

<center>
<img src = "https://raw.githubusercontent.com/v1otusc/PicBed/master/slam-frame.png">
</center>

## 2.4 编程基础

### 2.4.1 使用库

在一个 C++ 工程中, 只有带有 main 函数的文件才会生成可执行文件, 而另一些代码, 我们只想把它们打包成一个东西, 供其他程序调用, 这个东西叫做库.

编译成库, 在 CMakeLists.txt 中写:

```
add_library(hello libHelloSlam.cpp)
```

在 Linux 中, 库文件分成静态库和共享库两种. 静态库以 .a 作为后缀名. 共享库以 .so 结尾. 所有库都是一些函数打包后的集合, 差别在于静态库每次被调用都会生成一个副本, 而共享库则只有一个副本, 更省空间. 如果我们想生成共享库而不是静态库, 只需用:

```
add_library(hello_shared SHARED libHelloSlam.cpp)
```

对于库的使用者, **只要有了头文件和库文件, 就可以调用这个库了**, 然后在生成可执行文件的 CMakeLists.txt 文件中链接到库:

```
add_executable(useHello useHello.cpp)
target_link_library(useHello hello_shared)
```

> 带有 main 函数的源文件才能被编译为可执行文件, 其他的编译成库文件.

# 第三讲 三维空间刚体运动

## 3.1 旋转矩阵

### 3.1.1 点和向量, 坐标系

大部分程序库都使用右手坐标系.

向量的内积比较熟悉了, 用来描述向量之间的投影关系. 向量的外积以前也遇到过, 表示两个向量张成四边形的面积, 但是用到的不多, 用矩阵表示的样子也没见到过:

$$
    \boldsymbol{a} \times \boldsymbol{b} = \begin{bmatrix}
        \boldsymbol{i} & \boldsymbol{j} & \boldsymbol{k} \\
        a_1 & a_2 & a_3 \\
        b_1 & b_2 & b_3 \\
    \end{bmatrix} = \begin{bmatrix}
        a_2b_3 - a_3b_2 \\
        a_3b_1 - a_1b_3 \\
        a_1b_2 - a_2b_1
    \end{bmatrix} = \begin{bmatrix}
        0 & -a_3 & a_2 \\
        a_3 & 0 & -a_1 \\
        -a_2 & a_1 & 0 \\
    \end{bmatrix}\boldsymbol{b} = a\wedge b
$$

第三项是用一个[反对称矩阵](https://baike.baidu.com/item/%E5%8F%8D%E5%AF%B9%E7%A7%B0%E7%9F%A9%E9%98%B5/9063240?fr=aladdin)来表示 **a** 向量, 可以记作 **a**∧. 

### 3.1.2 坐标系之间的欧式变换

> 这部分 OpenGL 的课上讲过, 正好复习记录一下.

坐标变换指的是什么? 常见的情况是将机器人坐标系统观测到的点用世界坐标系(惯性坐标系来表示). 

相机运动是一个刚体运动, 向量在各个坐标系下的长度和夹角都不发生变化, 也就是说变换的形式仅有旋转和平移, 称作欧式变换.

对于同一向量在两个**单位正交基**下, 有对应的坐标:

$$
    [e_1, e_2, e_3]\begin{bmatrix}
        a_1 \\
        a_2 \\
        a_3
    \end{bmatrix} = 
    [e_1', e_2', e_3']\begin{bmatrix}
        a_1' \\
        a_2' \\
        a_3'
    \end{bmatrix}
$$

两边同时左乘一个:

$$
    [e_1^T, e_2^T, e_3^T]^T
$$

那么右边的系数就变成了一个单位矩阵, 变为:

$$
    \boldsymbol{a} = \begin{bmatrix}
        a_1 \\
        a_2 \\
        a_3
    \end{bmatrix} = \begin{bmatrix}
        e_1^Te_1' & e_1^Te_2'& e_1^Te_3' \\
        e_2^Te_1' & e_2^Te_2'& e_2^Te_3' \\
        e_3^Te_1' & e_3^Te_2'& e_3^Te_3'
    \end{bmatrix} \begin{bmatrix}
        a_1' \\
        a_2' \\
        a_3'
    \end{bmatrix} = R\boldsymbol{a'}
$$

可以看到 **R** 矩阵与基下的坐标是没什么关系的, 可以用来描述旋转过程本身, 称作旋转矩阵. 旋转矩阵是行列式为 1 的正交矩阵.

旋转矩阵的集合定义如下:

$$
    SO(n) = \{R\in R^{n×n} | RR^T = 1, det(R) = 1\}
$$  

其中, SO(n) 是特殊正交群的意思, SO(3) 就可以表示三维空间的旋转了.

欧式变换如果还有平移, 就直接再加一个向量就好了:

$$
    \boldsymbol{a} = \boldsymbol{Ra'} + \boldsymbol{t}
$$

### 3.1.3 变换矩阵与齐次坐标

如果一直采用以上变换, 形式上就会变得非常烦, 采用齐次坐标的做法就能解决这个问题:

$$
    \begin{bmatrix}
        a \\
        1
    \end{bmatrix} = \begin{bmatrix}
        R & t \\
        0^T & 1
    \end{bmatrix}\begin{bmatrix}
        a' \\
        1
    \end{bmatrix} = \boldsymbol{T}\begin{bmatrix}
        a' \\
        1
    \end{bmatrix}
$$

也就是在三维向量的末尾添加 1, 变成了四维向量, 称为齐次坐标. 其中 **T** 称作变换矩阵.

齐次坐标并不是唯一的, 某个点的分量同乘一个非零常数后, 仍表示同一个点, 但是当最后一点不为 0 时, 总是可以强制变为 1, 就得到了**唯一的非齐次坐标**.

$$
    \boldsymbol{x} = [x, y, z, w]^T = [x/w, y/w, z/w, 1]^T
$$

采用齐次坐标的方便之处在于:

$$
    \boldsymbol{b = T_1a, c = T_2b \Rightarrow c = T_2T_1a}
$$

和旋转矩阵类似, 变换矩阵的集合称作特殊欧式群, 记作:

$$
    SE(3) = \{T = \begin{bmatrix}
        R & t \\
        0^T & 1
    \end{bmatrix} R^{4×4} | R\in SO(3), t \in R^3\}
$$

求解变换矩阵的逆:

$$
    T^{-1} = \begin{bmatrix}
        R^T & -R^Tt \\
        0^T & 1
    \end{bmatrix}
$$

## 3.2 实践: Eigen 的使用

相比于其他库, Eigen 特殊之处在于, 它是一个纯用头文件搭建起来的库, 这意味着你只能找到它的头文件, 而没有 .so 或 .a 那样的二进制文件.

## 3.3 旋转向量和欧拉角

### 3.3.1 旋转向量



### 3.3.2 欧拉角


