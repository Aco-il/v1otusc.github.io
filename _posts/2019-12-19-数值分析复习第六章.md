---
layout: post
title: 数值分析复习第六章
---

<!-- TOC -->

- [常微分方程数值解法](#%e5%b8%b8%e5%be%ae%e5%88%86%e6%96%b9%e7%a8%8b%e6%95%b0%e5%80%bc%e8%a7%a3%e6%b3%95)
  - [6.1 微分方程数值解法概述](#61-%e5%be%ae%e5%88%86%e6%96%b9%e7%a8%8b%e6%95%b0%e5%80%bc%e8%a7%a3%e6%b3%95%e6%a6%82%e8%bf%b0)
  - [6.2 Euler 方法](#62-euler-%e6%96%b9%e6%b3%95)
    - [6.2.1 Euler 公式](#621-euler-%e5%85%ac%e5%bc%8f)
    - [6.2.2 后退 Euler 公式](#622-%e5%90%8e%e9%80%80-euler-%e5%85%ac%e5%bc%8f)
    - [6.2.3 梯形公式](#623-%e6%a2%af%e5%bd%a2%e5%85%ac%e5%bc%8f)
    - [6.2.4 预测校正系统与改进 Euler 公式](#624-%e9%a2%84%e6%b5%8b%e6%a0%a1%e6%ad%a3%e7%b3%bb%e7%bb%9f%e4%b8%8e%e6%94%b9%e8%bf%9b-euler-%e5%85%ac%e5%bc%8f)
    - [6.2.5 整体截断误差](#625-%e6%95%b4%e4%bd%93%e6%88%aa%e6%96%ad%e8%af%af%e5%b7%ae)
  - [6.3 Runge-Kutta 方法](#63-runge-kutta-%e6%96%b9%e6%b3%95)
    - [6.3.1 Runge-Kutta 方法基本思想](#631-runge-kutta-%e6%96%b9%e6%b3%95%e5%9f%ba%e6%9c%ac%e6%80%9d%e6%83%b3)
    - [6.3.2 2 阶 Runge-Kutta 公式](#632-2-%e9%98%b6-runge-kutta-%e5%85%ac%e5%bc%8f)
  - [6.4 单步方法的稳定性和收敛性](#64-%e5%8d%95%e6%ad%a5%e6%96%b9%e6%b3%95%e7%9a%84%e7%a8%b3%e5%ae%9a%e6%80%a7%e5%92%8c%e6%94%b6%e6%95%9b%e6%80%a7)

<!-- /TOC -->

> 考虑到再不复习就要挂科了, 为了激励自己, 特地来开一篇博客记录我的预习过程.

# 常微分方程数值解法

## 6.1 微分方程数值解法概述

讨论一阶方程初值问题:

$$
    \begin{cases}
        y' = f(x, y) & (a\leq x\leq b) \\
        y(a) = \eta
    \end{cases}
$$

的数值解法.

基本思路是对两端式子离散化后做一个积分.

*离散化方法 :* 如果计算某一值仅需要前一步的值, 称作单步方法. 如果需要前 r 步的值, 称作 r 步方法.

## 6.2 Euler 方法

### 6.2.1 Euler 公式

取 y<sub>0</sub> = η, 利用左矩形公式, 有:

$$
    y_{i+1} = y_i + hf(x_i, y_i)\quad (i = 0, 1, ..., n-1)
$$

称为求解初值问题的 Euler 公式, h 称为步长.

在计算 y<sub>i+1</sub> 时只用到了前一步的值. 另外, 如果 y<sub>i</sub> 已知, Euler 公式给出了 y<sub>i</sub> 和 y<sub>i+1</sub> 之间的显式依赖关系. 也就是说, 将 y<sub>i</sub> 代入上个式子的右边就能得到 y<sub>i+1</sub>, 满足以下一般格式:

$$
    \begin{cases}
        y_{i+1} = y_i + h\varphi(x_i, y_i, h)\quad i = 0, 1, 2, \cdots, n-1 \\
        y_0 = \eta
    \end{cases}
$$

称作**单步显式公式**, 称 φ(x<sub>i</sub>, y<sub>i</sub>, h) 为**增量函数**.

> 将精确解记作形如 y(x<sub>i</sub>), 近似值记作 y<sub>i</sub>.

一般来说, 精确解:

$$
    y(x_{i+1}) \not = {y(x_{i}) + h\varphi(x_i, y(x_i), h)}
$$

**局部截断误差定义:**

$$
    R_{i+1} = y(x_{i+1}) - [y(x_i) + h\varphi(x_i, y(x_i), h)]
$$

为单步显式公式在 x<sub>i+1</sub> 处的**局部截断误差**.

局部截断误差的计算公式为:

$$
    R_{i+1} = \frac{1}{2}h^2y''(\xi_i)\quad \xi \in (x_i, x_{i+1})
$$

### 6.2.2 后退 Euler 公式

取 y<sub>0</sub> = η, 利用右矩形公式, 有:

$$
    y_{i+1} = y_i + hf(x_{i+1}, y_{i+1})\quad (i = 0, 1, ..., n-1) \\
$$

或者

$$
    y_{i+1} = y_i + hf(x_{i} + h, y_{i+1})\quad (i = 0, 1, ..., n-1) \\
$$

称为求解初值问题的后退 Euler 公式, h 称为步长.

~~**这个方法实在是憨**~~, 已经知道 y<sub>i</sub> 无法代入方程中直接求出 y<sub>i+1</sub> 还是要另寻出路. 满足以下一般格式:

$$
    \begin{cases}
        y_{i+1} = y_i + h\varphi(x_{i+1}, y_i, y_{i+1}, h)\quad i = 0, 1, 2, \cdots, n-1 \\
        y_0 = \eta
    \end{cases}
$$

称作单步隐式格式. 后退 Euler 公式的增量函数 φ(x<sub>i</sub>, y<sub>i</sub>, h) 为 f(x<sub>i</sub>+h, y<sub>i+1</sub>).

**单步隐式格式的局部截断误差**的计算公式为:

$$
    R_{i+1} = -\frac{1}{2}h^2y''(\xi_i)\quad \xi \in (x_i, x_{i+1})
$$

> 与单步显式相比增加了一个负号.

### 6.2.3 梯形公式

取 y<sub>0</sub> = η, 利用梯形公式, 有:

$$
    y_{i+1} = y_i + \frac{h}{2}[f(x_{i+1}, y_{i+1}) + f(x_{i}, y_{i})]\quad (i = 0, 1, ..., n-1) \\
$$

**梯形公式的局部截断误差**的计算公式为:

$$
    R_{i+1} = -\frac{1}{12}h^3y'''(\xi_i)\quad \xi \in (x_i, x_{i+1})
$$

### 6.2.4 预测校正系统与改进 Euler 公式

> 层层递进, 避免求解隐式格式和增加误差的阶数 (减少误差), 真好.

首先用 Euler 给出一个粗糙的近似值

$$
    y_{i+1}^{(p)} = y_i + hf(x_i, y_i)
$$

称作**预测值**, Prediction.

然后将此式代入梯形公式的右式, 很好! 这样就避免了求解隐式格式, 就有:

$$
    y_{i+1} = y_i + \frac{h}{2}[f(x_{i+1}, y_{i+1}^{(p)}) + f(x_{i}, y_{i})]
$$

称作**校正值**, Correction.

也可以写成:

$$
    \begin{cases}
        y_{i+1}^{(p)} = y_i + hf(x_i, y_i) \\
        y_{i+1}^{(c)} = y_i + hf(x_{i+1}, y_{i+1}^{(p)}) \\
        y_{i+1} = \frac{1}{2}(y_{i+1}^{(p)} + y_{i+1}^{(c)})
    \end{cases}
$$

称作**改进 Euler 公式**.

也可以写成:

$$
    y_{i+1} = y_i + \frac{h}{2}[f(x_{i}, y_{i}) + f(x_{i+1}, y_{i} + hf(x_i, y_i))]
$$

从上式可以看出, 最终得到了单步 (只用到了上一步的求解结果) 显式 (避免求解隐式格式) 公式, 非常好!

研究一下它的局部截断误差:

$$
    R_{i+1} = y(x_{i+1}) - y(x_{i}) - \frac{h}{2}[f(x_{i}, y(x_{i})) + f(x_{i+1}, y(x_{i+1}))] \\
     + \frac{h}{2}[f(x_{i+1}, y(x_{i+1})) - f(x_{i+1}, y(x_{i}) + hf(x_{i}, y(x_{i})))]
$$

上面的等式用到了**加一项减一项**的技巧, 目的是为了得到形如梯形公式的局部截断误差:

$$
    -\frac{1}{12}y'''(\xi_i)h^3
$$

其中 ξ<sub>i</sub> ∈ (x<sub>i</sub>, x<sub>i+1</sub>)

> 上面的局部截断误差仅是第一行计算得到的局部截断误差.

第二行求解的结果略, 还是一个系数乘上 h<sup>3</sup>.

改进 Euler 公式和 Euler 公式都是单步显式格式, 但是前者的局部截断误差比后者高一阶, 为 O(h<sup>3</sup>), 误差更小.

### 6.2.5 整体截断误差

用某种方法求得的数值解 y<sub>1</sub>, y<sub>2</sub>, ..., y<sub>n</sub> 一般来说与步长 h 有关, 可以记作:

$$
    y_1^{[h]}, y_2^{[h]}, \cdots, y_n^{[h]}
$$

人们自然要问, 在每一个节点 x<sub>i</sub> 处的近似值 y<sub>i</sub><sup>[h]</sup> 与真实值之间的误差:

$$
    |y(x_i) - y_i^{[h]}| \quad i = 1, 2, \cdots, n
$$

是否足够小?

*整体截断误差的定义 :* 

$$
    E(h) = man_{1\leq i\leq n}|y(x_{i}) - y_i^{[h]}|
$$

如果

$$
    lim_{h\to 0}E(h) = 0
$$

> 根据上面的公式实在是没什么好求的. 首先这个精确值就让人很为难.

根据局部截断误差来确定整体截断误差, 如果一个求解公式的局部截断误差为 R<sub>i+1</sub> = O(h<sup>p+1</sup>) 则称这个求解公式是 p 阶的, 或称为具有 p 阶精度.

## 6.3 Runge-Kutta 方法

### 6.3.1 Runge-Kutta 方法基本思想



### 6.3.2 2 阶 Runge-Kutta 公式



## 6.4 单步方法的稳定性和收敛性