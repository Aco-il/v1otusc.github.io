---
layout: post
title: 数值分析复习第五章
---

<!-- TOC -->

- [数值积分与数值微分](#数值积分与数值微分)
    - [5.1 数值积分的基本概念](#51-数值积分的基本概念)
    - [5.2 插值型求积公式](#52-插值型求积公式)
        - [5.2.1 插值型求积公式](#521-插值型求积公式)
        - [5.2.2 代数精度](#522-代数精度)
        - [5.2.3 梯形公式, Simpson 公式和 Cotes 公式的截断误差](#523-梯形公式-simpson-公式和-cotes-公式的截断误差)
        - [5.2.4 求积公式的稳定性](#524-求积公式的稳定性)
    - [5.3 复化求积公式](#53-复化求积公式)
        - [5.3.1 复化梯形求积公式](#531-复化梯形求积公式)
        - [5.3.2 复化 Simpson 公式](#532-复化-simpson-公式)
        - [5.3.3 复化 Cotes 公式](#533-复化-cotes-公式)
    - [5.4 Romberg 求积公式](#54-romberg-求积公式)
    - [5.5 Gauss 求积公式](#55-gauss-求积公式)
        - [5.5.1 Gauss 求积公式](#551-gauss-求积公式)
        - [5.5.2 正交多项式](#552-正交多项式)
        - [5.5.3 区间 [-1, 1] 上的 Gauss 公式](#553-区间--1-1-上的-gauss-公式)
        - [5.5.3 区间 [a, b] 上的 Gauss 公式](#553-区间-a-b-上的-gauss-公式)
        - [5.5.4 Gauss 公式的截断误差](#554-gauss-公式的截断误差)
        - [5.5.5 Gauss 公式的收敛性和稳定性](#555-gauss-公式的收敛性和稳定性)

<!-- /TOC -->

> 考虑到再不复习就要挂科了, 为了激励自己, 特地来开一篇博客记录我的预习过程.

# 数值积分与数值微分

## 5.1 数值积分的基本概念

数值求积公式应该避免用原函数表示, 最好能由被积函数的值直接决定, 将其表示为:

$$
    \int_a^b f(x)dx \approx \sum_{k=1}^nf(x_k)Δx_k
$$

更一般地

$$
    \int_a^b f(x)dx \approx \sum_{k=0}^nA_kf(x_k)
$$

称 x<sub>k</sub> 为求积节点, 称 A<sub>k</sub> 为求积系数, 它仅与节点的选取有关, 而与 f(x) 的具体形式无关.

因此, 求解的关键在于确定求积节点和相应的求解系数. 

## 5.2 插值型求积公式

### 5.2.1 插值型求积公式

*插值型求积公式 :* 取 n + 1 个求积节点

$$
    I_n(f) = \sum_{k=0}^nA_kf(x_k)
$$

其中

$$
    A_k = \int_a^bl_k(x)dx \quad (k = 0, 1, \cdots, n)
$$

l<sub>k</sub>(x) 为插值基公式.

插值型求积公式的截断误差为:

$$
    R(f) = \int_a^b \frac{f^{(n+1)} \xi}{(n+1)!}\prod_{k=0}^{n}(x-x_k)dx
$$

如何选取求积节点? 很自然地会取等距节点.

*Newton-Cotes 公式:* 如果求积节点 x<sub>k</sub> 是等距的, 满足

$$
    x_k = a + kh (k = 0, 1, ..., n; \quad h = \frac{b - a}{n})
$$

根据 Newton-Cotes 公式求出 2 个求积节点的插值型求积公式

$$
    T(f) = \frac{b - a}{2}[f(a) + f(b)]
$$

> 这就是梯形公式

根据 Newton-Cotes 公式求出 3 个等距求积节点的插值型求积公式

$$
    S(f) = \frac{b - a}{6}[f(a) + 4f(\frac{a + b}{2}) + f(b)]
$$

> 这就是 Simpson 公式

根据 Newton-Cotes 公式求出 5 个等距求积节点的插值型求积公式

$$
    C(f) = \frac{b - a}{90}[7f(a) + 32f(\frac{3a + b}{4}) + 12f(\frac{a + b}{2}) + 32f(\frac{a + 3b}{4}) + 7f(b)]
$$

> 这就是 Cotes 公式 (了解, 不必记住)

### 5.2.2 代数精度

由截断误差定义:

$$
    R(f) = \int_a^b \frac{f^{(n+1)} (\xi)}{(n+1)!}\prod_{k=0}^{n}(x-x_k)dx
$$

根据此定义, 取得的求积的节点个数为 n + 1, 当 f(x) 最高次项为 n, 其 (n + 1) 次导数为 0, 也就是说**截断误差为 0**, 这时称插值型求积公式是精确的.

*代数精度定义 :* 如果求积公式对所有的 m 次多项式都是精确的, 但至少对一个 m + 1 次多项式是不精确的, 则称该求积公式具有 m 次代数精度.

因此, 具有 n + 1 个求积节点的插值型求积公式的代数精度至少为 n. 

*代数精度定理 1:* 求积公式, 取得的求积节点的个数为 n + 1 个, 那么其具有 n 次代数精度的充要条件是该公式为插值型的.

下面的定理可以用来验证一个求积公式的代数精度.

*代数精度定理 2:* 求积公式具有 m 次代数精度的充要条件为该公式对 f(x) = 1, x, x<sup>2</sup>, ..., x<sup>m</sup> 是精确的, 而对 f(x) = x<sup>m+1</sup> 不精确成立.

**可以证明 :** 当 n 为奇数时, Newton-Cotes 公式的代数的 n, 当 n 为偶数时, Newton-Cotes 公式的代数的 n + 1.

由此可见, 梯形公式, Simpson 公式和 Cotes 公式 (n = 1, 2, 4) 的代数精度分别为: 1, 3, 5.

### 5.2.3 梯形公式, Simpson 公式和 Cotes 公式的截断误差

梯形公式:

$$
    R_T(f) = -\frac{(b-a)^3}{12}f''(\eta)\quad \eta \in (a, b)
$$

Simpson 公式:

$$
    R_S(f) = -\frac{b-a}{180}(\frac{b-a}{2})^4f^{(4)}(\eta)\quad \eta \in (a, b)
$$

如何求截断误差也要会推导.

### 5.2.4 求积公式的稳定性

梯形公式, Simpson 公式和 Cotes 公式都是稳定的.

## 5.3 复化求积公式

> 基本思路是将积分区间分成若干个小区间, 在每一个小区间上应用求积公式.

对求积区间 [a, b] 作 n 等分 (n + 1 个点) , 并记:

$$
    h = \frac{b - a}{n}, x_k = a + kh\quad(k = 0, 1, 2, ..., n)
$$

于是

$$
    I(f) = \sum_{k=0}^{n-1}\int_{x_k}^{x_{k+1}}f(x)dx
$$

(注意求和的上下界).

### 5.3.1 复化梯形求积公式

> 下面的公式要求自己能够推导.

对每一个小区间上的积分

$$
    \int_{x_k}^{x_{k+1}}f(x)dx
$$

应用梯形公式, 得到复化梯形公式:

$$
    T_n(f) = \sum_{k=0}^{n-1}\frac{h}{2}[f(x_k) + f(x_{k+1})]
$$

或者

$$
    T_n(f) = \frac{h}{2}[f(x_0) + 2\sum_{k=1}^{n-1}f(x_k)+ f(x_n)]
$$

根据梯形公式的截断误差, 在每一个小区间中的截断误差为:

$$
    -\frac{h^3}{12}f''(\eta_k) \quad \eta \in (x_k, x_{k+1})
$$

复化梯形公式的截断误差为:

$$
    I(f) - T_n(f) = -\frac{h^3}{12}\sum_{k=0}^{n-1}f''(\eta_k)
$$

根据介值定理, 存在 η ∈ (a, b), 使得

$$
    \frac{1}{n} \sum_{k=0}^{n-1}f''(\eta_k) = f''(\eta)
$$

代入复化梯形公式的截断误差有:

$$
    I(f) - T_n(f) = -\frac{h^3}{12}nf''(\eta) = -\frac{b-a}{12}h^2f''(\eta)
$$

注意用到了 h · n = b - a.

将 max<sub>a≤x≤b</sub>\|f``(x)\| 记作 M<sub>2</sub>, 也就是说对于任意给定的精度 ϵ, 只要选定合适的 h, 使得:

$$
    \frac{b-a}{12}h^2M_2 \leq \epsilon
$$

就有

$$
    |I(f) - T_n(f)| = \frac{b-a}{12}h^2|f''(\eta)| \leq \frac{b-a}{12}h^2M_2 \leq \epsilon
$$

称复化梯形公式的截断误差为**先验误差估计式**.

> 还是像上面说的, 别记了, 直接推导挺好的.

推导过程不会就看书吧.

$$
    |I(f) - T_{2n}(f)| \approx \frac{1}{3}|T_{2n}(f) - T_{n}(f)| \leq \epsilon
$$

称为复化梯形公式的截断误差的**后验误差估计式**.

记

$$
    x_{k+\frac{1}{2}} = \frac{1}{2} (x_{k} + x_{k+1})
$$

则经过推导可得

$$
    T_{2n}(f) = \frac{1}{2}[T_{n}(f) + h\sum_{k=0}^{n-1}f(x_{k+\frac{1}{2}})]
$$

这样做的好处是在求 T<sub>2n</sub>(f) 时候可以利用已知的 T<sub>n</sub>(f).

### 5.3.2 复化 Simpson 公式

略过.

### 5.3.3 复化 Cotes 公式

> 这部分就算了.

## 5.4 Romberg 求积公式

对 T<sub>2n</sub>(f) 进行修正, 得到

$$
    S_n(f) = \frac{4}{3}T_{2n}f - \frac{1}{3}T_n(f)
$$

## 5.5 Gauss 求积公式

对于机械求积公式:

$$
    \int_a^bf(x)dx \approx \sum_{k=0}^nA_kf(x_k)
$$

适当选取节点位置就有可能提高代数精度, 其中含有 (2n + 2) 个待定参数 x<sub>k</sub> 和 A<sub>k</sub>, 其中 k = 0, ..., n. 适当选择这些参数可以使求积公式具有 (2n + 1) 次代数精度. <- 目的.

### 5.5.1 Gauss 求积公式

设有计算

$$
    I(f) = \int_a^bf(x)dx
$$

的求积公式.

$$
    I_n(f) = \sum_{k=0}^nA_kf(x_k)
$$

如果其代数精度为 2n + 1, 称此公式为 Gauss 公式, 称相应的求积节点为 Gauss 节点, 并且满足*代数精度定理 2*, 具体例子参考书上例子.

*Gauss 点性质 :* 相应的符号参考上面的定义, 序列 {x<sub>k</sub>}<sub>0</sub><sup>n</sup> 为 Gauss 节点的充要条件为多项式:

$$
    W_{n+1}(x) = (x-x_0)\cdots(x-x_n)
$$

与任意不超过 n 次的多项式 p(x) 正交:

$$
    \int_a^bp(x)W_{n+1}(x)dx = 0
$$

> 下面是求 Gauss 节点的一般方法.

### 5.5.2 正交多项式

*正交多项式以及正交多项式序列定义 :* n 次正交多项式满足

$$
    (g_l, g_k) = \int_a^bg_l(x)g_k(x)dx = 0\quad (l < k)
$$

则称 {g<sub>n</sub>(x)}<sub>0</sub><sup>∞</sup> 为区间 [a, b] 上的正交多项式序列, 称 g<sub>n</sub>(x) 为区间 [a, b] 上的 n 次正交多项式.

并且, **正交多项式序列**中的 n 次**正交多项式**在区间 (a,b) 上具有 n 个互异的零点.

*Legendre 多项式:* 

$$
    P_n(t) = \frac{1}{2^nn!}\frac{d^n(t^n - 1)^n}{dt^n}
$$

并且, Legendre 多项式 {P<sub>n</sub>(t)}<sub>n=0</sub><sup>∞</sup> 是区间 [-1, 1] 上的正交多项式序列.

### 5.5.3 区间 [-1, 1] 上的 Gauss 公式

考虑积分

$$
    I(g) = \int_{-1}^{1} g(t)dt
$$

根据上一节中的内容, (n + 1) 次 Legendre 多项式在区间 (-1, 1) 上有 (n + 1) 个零点, 并且由于 Legendre 多项式与任意 n 次多项式正交, 根据 Gauss 节点的性质, (n + 1) 次 Legendre 多项式 (记作 P<sub>n+1</sub>(t) ) 的零点就是 Gauss 点. Gauss 系数即为这些 Gauss 点对应的**插值基函数**在 [-1, 1] 上的积分, 记作

$$
    A_k = \int_{-1}^{1}\prod_{j=0,j\not ={k}}^{n}\frac{t - t_j}{t_k - t_j} \quad (k = 0, 1, ..., n)
$$

那么就有

$$
    I(g) = \int_{-1}^{1} g(t)dt = I_n(g) = \sum_{k=0}^{n}A_kg(t_k)
$$

### 5.5.3 区间 [a, b] 上的 Gauss 公式

略.

### 5.5.4 Gauss 公式的截断误差

Gauss 公式的截断误差为

$$
    R(f) = \int_a^bf(x)dx - \sum_{k=0}^nA_kf(x_k) \\
    \\
    = \frac{f^{(2n+2)}(\xi)}{(2n+2)!} \int_a^bW_{n+1}^2(x)dx
$$

其中

$$
    W_{n+1}(x) = (x - x_0)\cdots(x - x_n)\quad \xi \in (a, b)
$$

### 5.5.5 Gauss 公式的收敛性和稳定性

略.
